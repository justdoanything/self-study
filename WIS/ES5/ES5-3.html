<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°-ES5</title>
    <script src="_.js"></script>
    <script src="partial.js"></script>
  </head>

  <body>
    ğŸ”° Reference :
    <a
      href="https://www.inflearn.com/course/%ED%95%A8%EC%88%98%ED%98%95-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/lecture/6776?tab=curriculum&volume=1.00&speed=1.5"
      >Inflearn - ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì•Œì•„ë³´ëŠ” í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° (ES5)</a
    >
    <script>
      var products = [
        {
          is_selected: true, // <--- ì¥ë°”êµ¬ë‹ˆì—ì„œ ì²´í¬ ë°•ìŠ¤ ì„ íƒ
          name: "ë°˜íŒ”í‹°",
          price: 10000, // <--- ê¸°ë³¸ ê°€ê²©
          sizes: [
            // <---- ì¥ë°”êµ¬ë‹ˆì— ë‹´ì€ ë™ì¼ ìƒí’ˆì˜ ì‚¬ì´ì¦ˆ ë³„ ìˆ˜ëŸ‰ê³¼ ê°€ê²©
            { name: "L", quantity: 4, price: 0 },
            { name: "XL", quantity: 2, price: 0 },
            { name: "2XL", quantity: 3, price: 2000 }, // <-- ì˜µì…˜ì˜ ì¶”ê°€ ê°€ê²©
          ],
        },
        {
          is_selected: true,
          name: "í›„ë“œí‹°",
          price: 21000,
          sizes: [
            { name: "L", quantity: 2, price: -1000 },
            { name: "2XL", quantity: 4, price: 2000 },
          ],
        },
        {
          is_selected: false,
          name: "ë§¨íˆ¬ë§¨",
          price: 16000,
          sizes: [{ name: "L", quantity: 10, price: 0 }],
        },
      ];

      //1. ëª¨ë“  ìˆ˜ëŸ‰
      var total_quantity = _.reduce(function (tq, product) {
        return _.reduce(
          product.sizes,
          function (tq, size) {
            return tq + size.quantity;
          },
          tq
        );
      }, 0);

      _.go(products, total_quantity, console.log);

      //2. ì„ íƒ ëœ ì´ ìˆ˜ëŸ‰
      _.go(
        products,
        _.filter(_get("is_selected")),
        total_quantity,
        console.log
      );

      //3. ëª¨ë“  ê°€ê²©
      var total_price = _.reduce(function (tp, product) {
        return _.reduce(
          product.sizes,
          function (tp, size) {
            return tp + (product.price + size.price) * size.quantity;
          },
          tp
        );
      }, 0);

      _.go(products, total_price, console.log);

      //4. ì„ íƒ ëœ ì´ ê°€ê²©
      _.go(products, _.filter(_get("is_selected")), total_price, console.log);
    </script>
  </body>
</html>
